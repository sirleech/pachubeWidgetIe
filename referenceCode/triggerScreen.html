
<?xml version="1.0"?>
<html>
<head>
<title>PRODUCTION  Trigger Management Page v4.2</title>

<link href="http://c204dv1c.csda.gov.au/sendj1/r667/J.ISIS.VER1.CSS"
      rel="stylesheet" type="text/css">

<style>
   .button{ cursor:hand; background-color:blue; }
   .trig{ cursor:hand;}
   .mtCell{ cursor:default;}
   .trigHeader{ cursor:default;}
   td{ cursor:default;}
   div.onlineTitle
   {
    text-align:center;
    color:blue;
    font-weight:bold;
    text-decoration:underline;
    font-size:18;
   }
</style>
</head>
<body class="body"
      onload="changeOnline()"
      bgcolor="#EEEEEE"
      onkeypress="doKey()">
 <center>
  <h3>
   PRODUCTION  Trigger Management Page
  </h3>
 </center>
<table width="100%"><tbody><tr>
<td>
  <nobr>
  Online:
  <select id="trigOnline" onchange="changeOnline()">
<option selected>Us1</option>
<option>Us2</option>
</select>
</nobr>
</td>
<td>
<nobr>
Apsys:
<span id="apsysSelect"></span>
</nobr>
</td>
<td>
<nobr>
Action: <input type="text" id="trigAct" size="8" maxlength="8" />
</nobr>
</td>
<td>
<nobr>
Status:
<input type="text" id="trigSts" size="8" maxlength="8"/>
</nobr>
</td>
<td>
<nobr>
Keyword:
<input type="text" id="trigKwd" size="10" maxlength="10"/>
</nobr>
</td>
<td>
<nobr>
Error:
<input type="text" id="trigErr" size="8" maxlength="8" />
</nobr>
</td>
</tr>
<tr>
<td>
<nobr>
<input type="button" class="button" id="findTriggerButton" value="Find Triggers" style="BACKGROUND:#A0A0A0" onclick="findTriggers()" />
</nobr>
</td>
<td colspan="3">Refresh:
<nobr>
<input type="text" size="3" maxlength="3" id="refreshTimer" /> Seconds
</nobr>
</td>
<td>
<nobr>
Sort: Action <input type="radio" class="trig" name="sortBy" id="trigSortByAction" checked
 />
 Status <input type="radio" class="trig" name="sortBy" id="trigSortByStatus" />
</nobr>
</tr></tbody></table>
<hr/>

<center>

<div id="navLine"></div>
<a name="nav1"></a><div id="onlineName1" class="onlineTitle"></div>
<table border="1"><tbody id="table1"></tbody></table>
<br>
<a name="nav2"></a><div id="onlineName2" class="onlineTitle"></div>
<table border="1"><tbody id="table2"></tbody></table>
<br>
<a name="nav3"></a><div id="onlineName3" class="onlineTitle"></div>
<table border="1"><tbody id="table3"></tbody></table>
<br>
<a name="nav4"></a><div id="onlineName4" class="onlineTitle"></div>
<table border="1"><tbody id="table4"></tbody></table>
<br>
<a name="nav5"></a><div id="onlineName5" class="onlineTitle"></div>
<table border="1"><tbody id="table5"></tbody></table>
<br>
<a name="nav6"></a><div id="onlineName6" class="onlineTitle"></div>
<table border="1"><tbody id="table6"></tbody></table>
<br>
<a name="nav7"></a><div id="onlineName7" class="onlineTitle"></div>
<table border="1"><tbody id="table7"></tbody></table>


</center>
<script>

var oldRowName,activeApsys,activeApsysCnt,prod,timer,saf,activeOnlineCnt;
var lastRow,loadID, gUserId, updtAccess, pst, prod2;

var oldAction,oldStatus,oldOnline,oldApsy,oldError,oldSort;

//... Setup globals for the host names of the Onlines and the number
//... of onlines.  Done here at top for easier maintaince

// Dev JANC ports
var gDV1janc = 'C204DV1C.CSDA.GOV.AU'; //DV1 Connectionless
var gDV2janc = 'C204DV2C.CSDA.GOV.AU'; //DV2 Connectionless
var gDV3janc = 'C204DV3C.CSDA.GOV.AU'; //DV3 Connectionless
var gDV4janc = 'C204DV4C.CSDA.GOV.AU'; //DV4 Connectionless
var gDV5janc = 'C204DV5C.CSDA.GOV.AU'; //DV5 Connectionless

// Dev JANP ports
var gDV1janp = 'C204DV1P.CSDA.GOV.AU'; //DV1 Persistent host
var gDV2janp = 'C204DV2P.CSDA.GOV.AU'; //DV2 Persistent host
var gDV3janp = 'C204DV3P.CSDA.GOV.AU'; //DV3 Persistent host
var gDV4janp = 'C204DV4P.CSDA.GOV.AU'; //DV4 Persistent host
var gDV5janp = 'C204DV5P.CSDA.GOV.AU'; //DV5 Persistent host

// Test JANC ports
var gTS1janc = 'C204TS1C.CSDA.GOV.AU'; //TS1 Connectionless
var gTS2janc = 'C204TS2C.CSDA.GOV.AU'; //TS2 Connectionless
var gTS3janc = 'C204TS3C.CSDA.GOV.AU'; //TS3 Connectionless
var gTS4janc = 'C204TS4C.CSDA.GOV.AU'; //TS4 Connectionless
var gTS5janc = 'C204TS5C.CSDA.GOV.AU'; //TS5 Connectionless
var gTS6janc = 'C204TS6C.CSDA.GOV.AU'; //TS6 Connectionless
var gTS7janc = 'C204TS7C.CSDA.GOV.AU'; //TS7 Connectionless

// Test JANP ports
var gTS1janp = 'C204TS1P.CSDA.GOV.AU'; //TS1 Persistent host
var gTS2janp = 'C204TS2P.CSDA.GOV.AU'; //TS2 Persistent host
var gTS3janp = 'C204TS3P.CSDA.GOV.AU'; //TS3 Persistent host
var gTS4janp = 'C204TS4P.CSDA.GOV.AU'; //TS4 Persistent host
var gTS5janp = 'C204TS5P.CSDA.GOV.AU'; //TS5 Persistent host
var gTS6janp = 'C204TS6P.CSDA.GOV.AU'; //TS6 Persistent host
var gTS7janp = 'C204TS7P.CSDA.GOV.AU'; //TS7 Persistent host

// SAF US1 JANC ports
var gTUS1janc = 'T204US1c.CSDA.GOV.AU'; //SAF-T (Y)  US1 Connectionless
var gUUS1janc = 'U204US1c.CSDA.GOV.AU'; //SAF-U (B)  US1 Connectionless
var gVUS1janc = 'V204US1c.CSDA.GOV.AU'; //SAF-V (A)  US1 Connectionless
var gWUS1janc = 'W204US1c.CSDA.GOV.AU'; //SAF-W (C)  US1 Connectionless
var gXNX1janc = 'X204NX1c.CSDA.GOV.AU'; //SAF-X (N)  NX1 Connectionless

// PST US1 JANC ports
var gAPSTjanc = 'APSTUS1c.CSDA.GOV.AU'; //A (PST) US1 Connectionless host
var gBPSTjanc = 'BPSTUS1c.CSDA.GOV.AU'; //B (PST) US1 Connectionless host
var gNPSTjanc = 'NPSTNX1c.CSDA.GOV.AU'; //N (PST) NX1 Connectionless host

// Production US1 JANP ports
var gAUS1janp = 'A204US1P.CSDA.GOV.AU'; //A US1 Persistent host
var gBUS1janp = 'B204US1P.CSDA.GOV.AU'; //B US1 Persistent host
var gGUS1janp = 'G204US1P.CSDA.GOV.AU'; //G US1 Persistent host
var gHUS1janp = 'H204US1P.CSDA.GOV.AU'; //H US1 Persistent host
var gIUS1janp = 'I204US1P.CSDA.GOV.AU'; //I US1 Persistent host
var gJUS1janp = 'J204US1P.CSDA.GOV.AU'; //J US1 Persistent host
var gKUS1janp = 'K204US1P.CSDA.GOV.AU'; //K US1 Persistent host
var gMUS1janp = 'M204US1P.CSDA.GOV.AU'; //M US1 Persistent host
var gNNX1janp = 'N204NX1P.CSDA.GOV.AU'; //N NX1 Persistent host
var gPUS1janp = 'P204US1P.CSDA.GOV.AU'; //P US1 Persistent host
var gRUS1janp = 'R204US1P.CSDA.GOV.AU'; //R US1 Persistent host
var gSUS1janp = 'S204US1P.CSDA.GOV.AU'; //S US1 Persistent host
var gYUS1janp = 'Y204US1P.CSDA.GOV.AU'; //Y US1 Persistent host

// Production US1 JANC ports
var gAUS1janc = 'A204US1c.CSDA.GOV.AU'; //A US1 Connectionless host
var gBUS1janc = 'B204US1c.CSDA.GOV.AU'; //B US1 Connectionless host
var gGUS1janc = 'G204US1c.CSDA.GOV.AU'; //G US1 Connectionless host
var gHUS1janc = 'H204US1c.CSDA.GOV.AU'; //H US1 Connectionless host
var gIUS1janc = 'I204US1c.CSDA.GOV.AU'; //I US1 Connectionless host
var gJUS1janc = 'J204US1c.CSDA.GOV.AU'; //J US1 Connectionless host
var gKUS1janc = 'K204US1c.CSDA.GOV.AU'; //K US1 Connectionless host
var gMUS1janc = 'M204US1c.CSDA.GOV.AU'; //M US1 Connectionless host
var gNNX1janc = 'N204NX1c.CSDA.GOV.AU'; //N NX1 Connectionless host
var gPUS1janc = 'P204US1c.CSDA.GOV.AU'; //P US1 Connectionless host
var gRUS1janc = 'R204US1c.CSDA.GOV.AU'; //R US1 Connectionless host
var gSUS1janc = 'S204US1c.CSDA.GOV.AU'; //S US1 Connectionless host
var gYUS1janc = 'Y204US1c.CSDA.GOV.AU'; //Y US1 Connectionless host

// Production US2 JANP ports
var gAUS2janp = 'A204US2P.CSDA.GOV.AU'; //A US2 Persistent host
var gBUS2janp = 'B204US2P.CSDA.GOV.AU'; //B US2 Persistent host
var gGUS2janp = 'G204US2P.CSDA.GOV.AU'; //G US2 Persistent host
var gHUS2janp = 'H204US2P.CSDA.GOV.AU'; //H US2 Persistent host
var gIUS2janp = 'I204US2P.CSDA.GOV.AU'; //I US2 Persistent host
var gJUS2janp = 'J204US2P.CSDA.GOV.AU'; //J US2 Persistent host
var gKUS2janp = 'K204US2P.CSDA.GOV.AU'; //K US2 Persistent host
var gMUS2janp = 'M204US2P.CSDA.GOV.AU'; //M US2 Persistent host
var gNNX2janp = 'N204NX2P.CSDA.GOV.AU'; //N NX2 Persistent host
var gPUS2janp = 'P204US2P.CSDA.GOV.AU'; //P US2 Persistent host
var gRUS2janp = 'R204US2P.CSDA.GOV.AU'; //R US2 Persistent host
var gSUS2janp = 'S204US2P.CSDA.GOV.AU'; //S US2 Persistent host
var gYUS2janp = 'Y204US2P.CSDA.GOV.AU'; //Y US2 Persistent host

// Production US2 JANC ports
var gAUS2janc = 'A204US2c.CSDA.GOV.AU'; //A US2 Connectionless host
var gBUS2janc = 'B204US2c.CSDA.GOV.AU'; //B US2 Connectionless host
var gGUS2janc = 'G204US2c.CSDA.GOV.AU'; //G US2 Connectionless host
var gHUS2janc = 'H204US2c.CSDA.GOV.AU'; //H US2 Connectionless host
var gIUS2janc = 'I204US2c.CSDA.GOV.AU'; //I US2 Connectionless host
var gJUS2janc = 'J204US2c.CSDA.GOV.AU'; //J US2 Connectionless host
var gKUS2janc = 'K204US2c.CSDA.GOV.AU'; //K US2 Connectionless host
var gMUS2janc = 'M204US2c.CSDA.GOV.AU'; //M US2 Connectionless host
var gNNX2janc = 'N204NX2c.CSDA.GOV.AU'; //N NX2 Connectionless host
var gPUS2janc = 'P204US2c.CSDA.GOV.AU'; //P US2 Connectionless host
var gRUS2janc = 'R204US2c.CSDA.GOV.AU'; //R US2 Connectionless host
var gSUS2janc = 'S204US2c.CSDA.GOV.AU'; //S US2 Connectionless host
var gYUS2janc = 'Y204US2c.CSDA.GOV.AU'; //Y US2 Connectionless host


var gNumDevOnlines  = 5;  //Number of avaliable DEV  onlines
var gNumTestOnlines = 7;  //Number of avaliable TEST onlines
var gNumSAFOnlines  = 5;  //Number of avaliable SAF  onlines
var gNumPSTOnlines  = 3;  //Number of avaliable PST onlines
var gNumProdOnlines = 13; //Number of avaliable Prod onlines
var gNumTables = 7;       //Greater of gNumDevOnlines and gNumTestOnlines

//set up global array for holding the counts of active apsy's for each online/table
var apsyCntArray = new Array(gNumTables);

var devTest = 0;
var gSelectedOnline;

function doKey()
{
var keycode = window.event.keyCode;

if(keycode==13)//If the enter key is pressed
  findTriggers();
}

function createNavLine(prefix, count)
{
//... funtions works by grabing the name of the online from the select box options
//... Note: will only work if the Dv onlines are first 3 entries in the select box
//...       and Ts onlines are entries 5-10 in the select box

var i,onlineName;
//... to get the name of the Dv onlines have to minus 1 from the index
if(prefix == "Dv")
  diff = -1;
else //... else add number of dev onlines to the index for Ts onlines
  diff = gNumDevOnlines;

navLine.innerHTML="<b>Navigation:</b><br>";
for (i=1;i<=count;i++)
{
  onlineName = trigOnline[i+diff].text;
  navLine.innerHTML+="<b><a href=#nav"+i+">"+onlineName+"</a><b>  ";
}
navLine.innerHTML+="<br><br>";
}

function getTable(tblNum, newRequest, onlineName)
{
var row,table;

switch (tblNum)
{
case 1: table = table1;
        div = onlineName1;
        break;
case 2: table = table2;
        div = onlineName2;
        break;
case 3: table = table3;
          div = onlineName3;
        break;
case 4: table = table4;
          div = onlineName4;
        break;
case 5: table = table5;
          div = onlineName5;
        break;
case 6: table = table6;
          div = onlineName6;
        break;
case 7: table = table7;
          div = onlineName7;
}

if(newRequest){ //... if a new request then create title bar across top of table
    //... Add HTML label to indicate which online the table is for
    div.innerText = onlineName
    row = createTitleRow();
    table.appendChild(row);
}

return table;
}

function clearTables()
{
var len, wrkTable, label, nodes,i ,j;

for (i=1;i<=gNumTables;i++)
{
  switch (i)
  {
  case 1: wrkTable = table1;
          label = onlineName1;
          break;
  case 2: wrkTable = table2;
          label = onlineName2;
          break;
  case 3: wrkTable = table3;
          label = onlineName3;
          break;
  case 4: wrkTable = table4;
          label = onlineName4;
          break;
  case 5: wrkTable = table5;
          label = onlineName5;
          break;
  case 6: wrkTable = table6;
          label = onlineName6;
          break;
  case 7: wrkTable = table7;
          label = onlineName7;
  }

  nodes=wrkTable.rows;
  len=nodes.length;
  for(j=len;j;j--)
      wrkTable.removeChild(nodes[j-1]);

  //... clear table labels as well
  label.innerText = "";
}
}

function createTitleRow()
{
var row;

row = document.createElement("tr");
row.bgColor = "lightblue";
appendCell(row,'Action');
appendCell(row,'Status');

return row;
}

//... This function finds the row for the action or status in the selected table
function findRow(table,trigAct,trigSts,start)
{
var tableCnt;

tableCnt = table.rows.length;
if(trigSortByAction.checked){
  for(i=start;i<tableCnt;i++){
    row = table.rows[i];
    rowName = row.getAttribute("name");
    rowSts = row.getAttribute("sts");
    if(rowName==trigAct){
      if(rowSts>trigSts)
        return row.rowIndex;
    }else if(rowName>trigAct){
      return row.rowIndex;
    }
  }
}else{
  for(i=start;i<tableCnt;i++){

    row = table.rows[i];
    rowName = row.getAttribute("name");
    rowSts = row.getAttribute("sts");

    if(rowSts==trigSts){
      if(rowName>trigAct)
        return row.rowIndex;
    }else if(rowSts>trigSts){
      return row.rowIndex;
    }

  }
}
return tableCnt;
}

function addRow(table,rowIndex,column,name,sts,cnt,apsyCnt,showName,updId,updAccess)
{
var row,cell,i,nextRow,nextRowCell,addAsBlankName,cellHtmlText;
var logBugErr;

if(trigAct.value!=''){
  if(name!=trigAct.value)
    return;
}
if(trigSts.value!=''){
  if(sts!=trigSts.value)
    return;
}
row = document.createElement("tr");
row.title = "Action : " + name + "\n"
          + "Status : " + sts;
row.id = name + ';' + sts + ';';
row.name = name;
row.setAttribute("sts",sts);
row.bgColor = "white";

cell = document.createElement("td");
if(showName){ //... If a new trigger name
  cell.id = name + ';';
  cell.name = name;
  cell.title = 'Click here to change search to ' + name;
  cell.innerHTML = '<span name=' + name + ' onclick="setTrigAction()">'
                 + name + '</span>';
}else{
  addAsBlankName = true;
  if(rowIndex){
    nextRow = table.rows[rowIndex];
    if(nextRow){
      nextRowCell = nextRow.cells[0];
      if(nextRowCell){
        //... If the next row already has the same 'name' then blank out the name
        //    on the next row. Note: This happens only when searching on trigger name
        if(nextRowCell.innerText==name){
          nextRowCell.id = '';
          nextRowCell.innerHTML = '&nbsp;';
          cell.id = name + ';';
          cell.innerText = name;
          addAsBlankName = false;
        }
      }
    }
  }
  if(addAsBlankName)
    cell.innerHTML = '&nbsp;';
}

cell.bgColor = 'azure';
cell.className = "trig";
row.appendChild(cell);

cell = document.createElement("td");
cell.id = name + ';' + sts + ';';
cell.bgColor = 'azure';
cell.className = "trig";
cell.innerHTML = '<span name=' + sts + ' onclick="setTrigSts()">'
                 + sts + '</span>';
row.appendChild(cell);

//add onclick so that triggers are updateable.

for(i=0;i<apsyCnt;i++){
  cell = document.createElement("td");
  cell.id = name + ';' + sts + ';' + i + ';';
  cell.width = 70;
  cell.align = 'right';

  logBugErr = false;
  if (sts == '#LOG' || sts == '#ERROR' ||
      sts == '#CAN' || sts == '#COM'   ||
      sts == '#BUG' || sts == '#ERRZZ'  ) logBugErr = true;

  if (logBugErr)
  {
    cell.innerHTML = '<span name=' + cell.id + ' id=' + updId +
                     ' onclick="displayMoreInfo(id)">'
                     + cnt + '</span>';
  }
  else
  {
    if (updAccess == 'Y')
    {
      // add string literals around id as it may contain a space - u32.
      cell.innerHTML = '<span name=' + cell.id + ' id=' + '"' + updId +
                       '"' +
                      ' onclick="updTriggerStatus(id);findTriggers()">'
                       + cnt + '</span>';
    }
  }

  if(i==column){
    cell.loadID = loadID;
    if (logBugErr)
    {
      cell.innerHTML = '<span name=' + cell.id + ' id=' + updId +
                       ' onclick="displayMoreInfo(id)">'
                       + cnt + '</span>';
      cell.className = "trig";
    }
    else
    {
      if (updAccess == 'Y')
      {
       // add string literals around id as it may contain a space - u32
       cell.innerHTML = '<span name=' + cell.id + ' id=' + '"' + updId
                        + '"' +
                      ' onclick="updTriggerStatus(id);findTriggers()">'
                        + cnt + '</span>';
       cell.className = "trig";
      }
      else
      {
        cell.innerText = cnt;
        cell.className = "mtCell";
      }
    }
  }else{
    cell.innerHTML = '&nbsp;';
    cell.className = "mtCell";
  }

   row.appendChild(cell);

  if(apsySelect.selectedIndex)
    break;

  if(!prod)
    if(!saf)
       if(!pst)
         if(i==apsyCnt-2)
           break;

}
//... Add cell for totals
cell = document.createElement("td");
cell.bgColor = "azure";
cell.width = 70;
cell.align = 'right';
cell.className = "trig";
cell.innerText = " ";
row.appendChild(cell);

if(rowIndex<table.rows.length)
  table.insertBefore(row,table.rows[rowIndex]);
else
  table.appendChild(row);

return rowIndex;
}

function setTrigAction()
{
//... Get the name of the event that called this function
var src = window.event.srcElement;
if(src){
  //... the src.name will be the id of the cell which triggered this function
  var name = src.name;
  if(name){
    trigAct.value = name;
    trigSts.value = '';
    findTriggers();
  }
}
}

// call trigger update program to send to mainframe and update recs.

function updTriggerStatus(updInfo)
{
   var count, status, action, apsy, parmArray, tok;
   var newObject    = new Object();

   parmArray           = updInfo.split(";")
   newObject.action    = parmArray[0]
   newObject.status    = parmArray[1]
   newObject.count     = parmArray[2]
   newObject.updSfx    = parmArray[3]
   newObject.updhost   = parmArray[4]
   newObject.updUserId = parmArray[5]
   newObject.kwd       = parmArray[6]
   newObject.logApsy   = parmArray[7]

   tok = tokenApplet.getToken();
   msgWindow = window.showModalDialog(
      'HTTP://c204dv1c.csda.gov.au/trigs/upd?token='+tok,newObject,
      'dialogHeight: 500px; dialogWidth: 680px;');

}

function displayMoreInfo(updInfo)
{

 var action, apsy, count, sfx, status, parmArray, host;
 var userId, onRuleQual, tok, kwd;

 parmArray = updInfo.split(";")
 action = parmArray[0]
 status = parmArray[1]
 count  = parmArray[2]
 sfx    = parmArray[3]
 host   = parmArray[4]
 userId = parmArray[5]
 kwd    = parmArray[6]
 logApsy = parmArray[7]

 var randomNum = Math.round(Math.random() * 1000);

 if (logApsy=="JIISM")
 {
   onRuleQual = "/refrj";
 }
 else if (logApsy=="JINIM")
 {
   onRuleQual = "/isisn"
 }

 tok = tokenApplet.getToken();

 var url = "http://"+ host + onRuleQual + sfx + "/r" + randomNum +
           "/XML/P.TRIGS.HTML.MORE.INFO" +
           "?action=" + escape(action)   +
           "&kwd="    + escape(kwd)      +
           "&status=" + escape(status)   +
           "&count="  + escape(count)    +
           "&token="  + escape(tok);

 window.open(url,
          "_blank",
          "toolbar=no,location=no,scrollbars=yes,width=900,Height=400")

}

function setTrigSts()
{
//... Get the name of the event that called this function
var src = window.event.srcElement;
if(src){
  //... the src.name will be the id of the cell which triggered this function
  var name = src.name;
  if(name){
    trigAct.value = '';
    trigSts.value = name;
    findTriggers();
  }
}
}

function appendTitle(table, name)
{
 appendCell(table.rows[0],name);
}

function appendCell(row,value)
{
var cell;
cell = document.createElement("td");
cell.innerText = value;
cell.align = 'center';
row.appendChild(cell);
return row;
}

function changeOnline()
{
var len,i,doc,host;
apsysSelect.innerHTML = "Loading";

gUserId = tokenApplet.getUserId();

saf  = false;
pst  = false;
prod = false;
prod2 = false;
allts= false;
alldv= false;
gSelectedOnline = trigOnline[trigOnline.selectedIndex].text;

switch(gSelectedOnline)
{
  case "Dv1": host  = gDV1janp; break; //DV1
  case "Dv2": host  = gDV2janp; break; //DV2
  case "Dv3": host  = gDV3janp; break; //DV3
  case "Dv4": host  = gDV4janp; break; //DV4
  case "Dv5": host  = gDV5janp; break; //DV5
  case "Dev onlines": alldv = true; break;
  case "Ts1": host  = gTS1janp; break; //TS1
  case "Ts2": host  = gTS2janp; break; //TS2
  case "Ts3": host  = gTS3janp; break; //TS3
  case "Ts4": host  = gTS4janp; break; //TS4
  case "Ts5": host  = gTS5janp; break; //TS5
  case "Ts6": host  = gTS6janp; break; //TS6
  case "Ts7": host  = gTS7janp; break; //TS7
  case "Test onlines": allts= true; break;
  case "PST": pst  = true; break;
  case "SAF": saf  = true; break;
  case "Us1": prod = true; break;
  case "Us2": prod2 = true; break;
}

if(prod || prod2){
  str = "<select id='apsySelect'><option selected>ALL</option>";
  str += "<option>A</option>";
  str += "<option>B</option>";
  str += "<option>G</option>";
  str += "<option>H</option>";
  str += "<option>I</option>";
  str += "<option>J</option>";
  str += "<option>K</option>";
  str += "<option>M</option>";
  str += "<option>N</option>";
  str += "<option>P</option>";
  str += "<option>R</option>";
  str += "<option>S</option>";
  str += "<option>Y</option>";
  str += "</select>";
  apsysSelect.innerHTML = str;
  activeApsysCnt = gNumProdOnlines; //set at start of code
  return;
}else if(saf){
  str = "<select id='apsySelect'><option selected>ALL</option>";
  str += "<option>T (env: Y)</option>";
  str += "<option>U (env: B)</option>";
  str += "<option>V (env: A)</option>";
  str += "<option>W (env: C)</option>";
  str += "<option>X (env: N)</option>";
  str += "</select>";
  apsysSelect.innerHTML = str;
  activeApsysCnt = gNumSAFOnlines; //set at start of code
  return;
}else if(pst){
  str = "<select id='apsySelect'><option selected>ALL</option>";
  str += "<option>A (env: A)</option>";
  str += "<option>B (env: B)</option>";
  str += "<option>X (env: N)</option>";
  str += "</select>";
  apsysSelect.innerHTML = str;
  activeApsysCnt = gNumPSTOnlines; //set at start of code
  return;
}else if(allts){
  str = "<select id='apsySelect'><option selected>ALL</option>";
  str += "</select>";
  apsysSelect.innerHTML = str;
  activeOnlineCnt = gNumTestOnlines; //set at start of code
  return;
}else if(alldv){
  str = "<select id='apsySelect'><option selected>ALL</option>";
  str += "</select>";
  apsysSelect.innerHTML = str;
  activeOnlineCnt = gNumDevOnlines; //set at start of code
  return;
}

//... Values are not hard coded so retrieve the names of the Apsy's
//    from the Host environment
activeApsysCnt = apsyForOnline(host);
}

function apsyForOnline(host)
{
var len,i,doc,updAccess;
url = "http://" + host + "/st1/p.jwp.all.apsys.xml.build?uid="+gUserId;

doc = new ActiveXObject('msxml.domdocument');
doc.async = false;
doc.load(url);

activeApsys = new Array();
activeApsysCnt = 0;
activeApsys[activeApsysCnt++]='ALL';

str = "<select id='apsySelect'><option selected>ALL</option>";
apsyNodes = doc.selectNodes('/apsys/apsy');
len = apsyNodes.length;
for(i=0;i<len;i++){
  apsyNode = apsyNodes[i];
  name = apsyNode.getAttribute("name");
  updAccess = apsyNode.getAttribute("userAccess");
  if(name.substr(0,5)=="JIISM" || name.substr(0,5)=="JINIM")
  {
    // Don't display 'private' apsys unless the user has access to them
    // (note that "userAccess" will be "1" for non-private apsys)
    if(updAccess=="1")
    {
       name = name.substr(2,4);
       activeApsys[activeApsysCnt++]=name;
       str += "<option>" + name + "</option>";
    }
  }
}
str += "</select>";
apsysSelect.innerHTML = str;

return activeApsysCnt;
}

function findTriggers()
{

var len,i,name,url,host,parms,newRequest,curTable;
var onlineName,onRuleQual;
saf   = false;
prod  = false;
prod2 = false;
pst   = false;
allts = false;
alldv = false;

switch(gSelectedOnline)
{
  case "Dv1": host          = gDV1janc; break; //DV1
  case "Dv2": host          = gDV2janc; break; //DV2
  case "Dv3": host          = gDV3janc; break; //DV3
  case "Dv4": host          = gDV4janc; break; //DV4
  case "Dv5": host          = gDV5janc; break; //DV5
  case "Dev onlines": alldv = true; break;
  case "Ts1": host          = gTS1janc; break; //TS1
  case "Ts2": host          = gTS2janc; break; //TS2
  case "Ts3": host          = gTS3janc; break; //TS3
  case "Ts4": host          = gTS4janc; break; //TS4
  case "Ts5": host          = gTS5janc; break; //TS5
  case "Ts6": host          = gTS6janc; break; //TS6
  case "Ts7": host          = gTS7janc; break; //TS7
  case "Test onlines": allts= true; break;
  case "PST": pst           = true; break;
  case "SAF": saf           = true; break;
  case "Us1": prod          = true; break;
  case "Us2": prod2         = true; break;
}

trigAct.value = trigAct.value.toUpperCase();
trigSts.value = trigSts.value.toUpperCase();
trigKwd.value = trigKwd.value.toUpperCase();

//Check to see if any selection criteria has changed
if(trigAct.value!=oldAction            ||
   trigSts.value!=oldStatus            ||
   trigKwd.value!=oldKeyword           ||
   trigOnline.selectedIndex!=oldOnline ||
   apsySelect.selectedIndex!=oldApsy   ||
   trigSortByAction.checked!=oldSort   ||
   trigErr.value!=oldError)
{
  newRequest = true;

  //... Remove all rows from all the tables displayed on screen
  clearTables();

  oldAction  = trigAct.value;
  oldStatus  = trigSts.value;
  oldKeyword = trigKwd.value;
  oldOnline  = trigOnline.selectedIndex;
  oldApsy    = apsySelect.selectedIndex;
  oldError   = trigErr.value;
  oldSort    = trigSortByAction.checked;

}
else
  newRequest = false

//... If there has no search crieria selected then don't do any processing
if(!apsySelect.selectedIndex)
{
  if(trigAct.value=='' && trigSts.value=='')
  {
    alert('When ALL apsys selected, Action or Status must be supplied');
    findTriggerButton.disabled = false;
    return;
  }
}

findTriggerButton.disabled = true;
window.status = "Calculating ...";

parms = '?epedc=' + escape('*');
if(trigAct.value!='')
  parms += "&name=" + escape(trigAct.value);
if(trigSts.value!='')
  parms += "&sts=" + escape(trigSts.value);
if(trigKwd.value!='')
  parms += "&kwd=" + escape(trigKwd.value);
if(trigErr.value!='')
  parms += "&err=" + escape(trigErr.value);
if(trigSortByAction.checked)
  parms += "&sortBy=A";
else
  parms += "&sortBy=S";

parms += "&userId=" + gUserId;

navLine.innerHTML="";

//... Get the name of the online selected from the select box
onlineName = trigOnline[trigOnline.selectedIndex].text;
//... If all apsy's selected
if(!apsySelect.selectedIndex)
{

  //... Store the number of Active Apsys in global array
  //    only one table so only store value in first array slot
  apsyCntArray[0] = activeApsysCnt;

  if(prod){

    curTable = getTable(1, newRequest, onlineName);

    for(i=0;i<activeApsysCnt;i++){
      switch(i){
        case 0:host=gAUS1janc;name='A';break;
        case 1:host=gBUS1janc;name='B';break;
        case 2:host=gGUS1janc;name='G';break;
        case 3:host=gHUS1janc;name='H';break;
        case 4:host=gIUS1janc;name='I';break;
        case 5:host=gJUS1janc;name='J';break;
        case 6:host=gKUS1janc;name='K';break;
        case 7:host=gMUS1janc;name='M';break;
        case 8:host=gNNX1janc;name='N';break;
        case 9:host=gPUS1janc;name='P';break;
        case 10:host=gRUS1janc;name='R';break;
        case 11:host=gSUS1janc;name='S';break;
        case 12:host=gYUS1janc;name='Y';break;
      }
      if (name=='N')
      {
        onRuleQual = "/isisn1"
      }
      else
      {
        onRuleQual = "/isisj1"
      }
      url = "http://" + host + onRuleQual + "/trigxml" + parms;
      if(newRequest)
        appendTitle(curTable, name);

      loadDoc(url,i,curTable);
    }
  }else if(prod2){

    curTable = getTable(1, newRequest, onlineName);

    for(i=0;i<activeApsysCnt;i++){
      switch(i){
        case 0:host=gAUS2janc;name='A';break;
        case 1:host=gBUS2janc;name='B';break;
        case 2:host=gGUS2janc;name='G';break;
        case 3:host=gHUS2janc;name='H';break;
        case 4:host=gIUS2janc;name='I';break;
        case 5:host=gJUS2janc;name='J';break;
        case 6:host=gKUS2janc;name='K';break;
        case 7:host=gMUS2janc;name='M';break;
        case 8:host=gNNX2janc;name='N';break;
        case 9:host=gPUS2janc;name='P';break;
        case 10:host=gRUS2janc;name='R';break;
        case 11:host=gSUS2janc;name='S';break;
        case 12:host=gYUS2janc;name='Y';break;
      }
      if (name=='N')
      {
        onRuleQual = "/isisn1"
      }
      else
      {
        onRuleQual = "/isisj1"
      }
      url = "http://" + host + onRuleQual + "/trigxml" + parms;
      if(newRequest)
        appendTitle(curTable, name);

      loadDoc(url,i,curTable);
    }
  }else if(saf){
    curTable = getTable(1, newRequest, onlineName);

    for(i=0;i<activeApsysCnt;i++){
      switch(i){
        case 0:host=gTUS1janc;name='T';break;
        case 1:host=gUUS1janc;name='U';break;
        case 2:host=gVUS1janc;name='V';break;
        case 3:host=gWUS1janc;name='W';break;
        case 4:host=gXNX1janc;name='X';break;
      }
      if (name=='X')
      {
        onRuleQual = "/isisn1"
      }
      else
      {
        onRuleQual = "/isisj1"
      }
      url = "http://" + host + onRuleQual + "/trigxml" + parms;

      if(newRequest)
        appendTitle(curTable, name);
      loadDoc(url,i,curTable);
    }
  }else if(pst){
    curTable = getTable(1, newRequest, onlineName);

    for(i=0;i<activeApsysCnt;i++){
      switch(i){
        case 0:host=gAPSTjanc;name='A';break;
        case 1:host=gBPSTjanc;name='B';break;
        case 2:host=gNPSTjanc;name='X';break;
      }
      if (name=='X')
      {
        onRuleQual = "/isisn1"
      }
      else
      {
        onRuleQual = "/isisj1"
      }
      url = "http://" + host + onRuleQual + "/trigxml" + parms;

      if(newRequest)
        appendTitle(curTable, name);
      loadDoc(url,i,curTable);
    }
  }else if(allts)
  {
    for(i=1;i<=activeOnlineCnt;i++)
    {

      createNavLine("Ts",activeOnlineCnt);

      switch(i)
      {
        case 1: host = gTS1janp; break; //TS1
        case 2: host = gTS2janp; break; //TS2
        case 3: host = gTS3janp; break; //TS3
        case 4: host = gTS4janp; break; //TS4
        case 5: host = gTS5janp; break; //TS5
        case 6: host = gTS6janp; break; //TS6
        case 7: host = gTS7janp; break; //TS7
      }

      //... generate the active apsys for next online
      apsysCnt = apsyForOnline(host);

      switch(i)
      {
        case 1: host = gTS1janc; break; //TS1
        case 2: host = gTS2janc; break; //TS2
        case 3: host = gTS3janc; break; //TS3
        case 4: host = gTS4janc; break; //TS4
        case 5: host = gTS5janc; break; //TS5
        case 6: host = gTS6janc; break; //TS6
        case 7: host = gTS7janc; break; //TS7
      }

      onlineName = trigOnline[i+gNumDevOnlines].text;

      curTable = getTable(i, newRequest, onlineName);
      //... Store the number of Active Apsys in global array
      apsyCntArray[i-1] = apsysCnt;

      for(j=1;j<apsysCnt;j++)
      {
         name = activeApsys[j];
         if(name.substr(0,3)=="ISM")
         {
           onRuleQual = "/isisj"
         }
         else if(name.substr(0,3)=="NIM")
         {
           onRuleQual = "/isisn"
         }
         url = "http://" + host + onRuleQual + name.substr(3,1)
            + "/trigxml" + parms;

         if(newRequest)
           appendTitle(curTable, name);

         loadDoc(url,j-1,curTable);
      }
    }

  }else if(alldv)
  {
    createNavLine("Dv",activeOnlineCnt);

    for(i=1;i<=activeOnlineCnt;i++)
    {
      switch(i)
      {
        case 1: host = gDV1janp; break;
        case 2: host = gDV2janp; break;
        case 3: host = gDV3janp; break;
        case 4: host = gDV4janp; break;
        case 5: host = gDV5janp;
      }

      //... get the active apsys for next online
      apsysCnt = apsyForOnline(host);

      switch(i)
      {
        case 1: host = gDV1janc; break;
        case 2: host = gDV2janc; break;
        case 3: host = gDV3janc; break;
        case 4: host = gDV4janc; break;
        case 5: host = gDV5janc;
      }
      //... Get the name of the online frome select box options
      //... Note: Dv onlines are first 5 entries in the select box
      onlineName = trigOnline[i-1].text;
      curTable = getTable(i, newRequest, onlineName);
      //... Store the number of Active Apsys in global array
      apsyCntArray[i-1] = apsysCnt;

      for(j=1;j<apsysCnt;j++)
      {
         name = activeApsys[j];
         if(name.substr(0,3)=="ISM")
         {
           onRuleQual = "/isisj"
         }
         else if(name.substr(0,3)=="NIM")
         {
           onRuleQual = "/isisn"
         }
         url = "http://" + host + onRuleQual + name.substr(3,1)
            + "/trigxml" + parms;

         if(newRequest)
           appendTitle(curTable, name);
         loadDoc(url,j-1,curTable);
      }
    }
  }else
  {
    onlineName = trigOnline[trigOnline.selectedIndex].text;
    curTable = getTable(1, newRequest, onlineName);

    for(i=1;i<activeApsysCnt;i++)
    {
      name = activeApsys[i];
      if(name.substr(0,3)=="ISM")
      {
        onRuleQual = "/isisj"
      }
      else if(name.substr(0,3)=="NIM")
      {
        onRuleQual = "/isisn"
      }
      url = "http://" + host + onRuleQual + name.substr(3,1)
         + "/trigxml" + parms;

      if(newRequest)
        appendTitle(curTable, name);

      loadDoc(url,i-1,curTable);
    }
  }
}
else{ //... if a single apsy is selected
  apsyCntArray[0] = 1; //set apsy count to 1
  if(prod){
    curTable = getTable(1, newRequest, onlineName);
    switch(apsySelect.selectedIndex){
      case 1:host=gAUS1janc;name='A';break;
      case 2:host=gBUS1janc;name='B';break;
      case 3:host=gGUS1janc;name='G';break;
      case 4:host=gHUS1janc;name='H';break;
      case 5:host=gIUS1janc;name='I';break;
      case 6:host=gJUS1janc;name='J';break;
      case 7:host=gKUS1janc;name='K';break;
      case 8:host=gMUS1janc;name='M';break;
      case 9:host=gNNX1janc;name='N';break;
      case 10:host=gPUS1janc;name='P';break;
      case 11:host=gRUS1janc;name='R';break;
      case 12:host=gSUS1janc;name='S';break;
      case 13:host=gYUS1janc;name='Y';break;
    }
    if (name=='N')
    {
      onRuleQual = "/isisn1"
    }
    else
    {
      onRuleQual = "/isisj1"
    }
    url = "http://" + host + onRuleQual + "/trigxml" + parms;

    if(newRequest)
      appendTitle(curTable, name);

    loadDoc(url,0,curTable);
  }else if(prod2){
    curTable = getTable(1, newRequest, onlineName);
    switch(apsySelect.selectedIndex){
      case 1:host=gAUS2janc;name='A';break;
      case 2:host=gBUS2janc;name='B';break;
      case 3:host=gGUS2janc;name='G';break;
      case 4:host=gHUS2janc;name='H';break;
      case 5:host=gIUS2janc;name='I';break;
      case 6:host=gJUS2janc;name='J';break;
      case 7:host=gKUS2janc;name='K';break;
      case 8:host=gMUS2janc;name='M';break;
      case 9:host=gNNX2janc;name='N';break;
      case 10:host=gPUS2janc;name='P';break;
      case 11:host=gRUS2janc;name='R';break;
      case 12:host=gSUS2janc;name='S';break;
      case 13:host=gYUS2janc;name='Y';break;
    }
    if (name=='N')
    {
      onRuleQual = "/isisn1"
    }
    else
    {
      onRuleQual = "/isisj1"
    }
    url = "http://" + host + onRuleQual + "/trigxml" + parms;

    if(newRequest)
      appendTitle(curTable, name);

    loadDoc(url,0,curTable);
  }else if(saf){
    curTable = getTable(1, newRequest, onlineName);
    switch(apsySelect.selectedIndex){
      case 1:host=gTUS1janc;name='T';break;
      case 2:host=gUUS1janc;name='U';break;
      case 3:host=gVUS1janc;name='V';break;
      case 4:host=gWUS1janc;name='W';break;
      case 5:host=gXNX1janc;name='X';break;
    }
    if (name=='X')
    {
      onRuleQual = "/isisn1"
    }
    else
    {
      onRuleQual = "/isisj1"
    }
    url = "http://" + host + onRuleQual + "/trigxml" + parms;

    if(newRequest)
      appendTitle(curTable, name);;
    loadDoc(url,0,curTable);
  }else if(pst){
    curTable = getTable(1, newRequest, onlineName);
    switch(apsySelect.selectedIndex){
      case 1:host=gAPSTjanc;name='A';break;
      case 2:host=gBPSTjanc;name='B';break;
      case 3:host=gNPSTjanc;name='X';break;
    }
    if (name=='X')
    {
      onRuleQual = "/isisn1"
    }
    else
    {
      onRuleQual = "/isisj1"
    }
    url = "http://" + host + onRuleQual + "/trigxml" + parms;

    if(newRequest)
      appendTitle(curTable, name);;
    loadDoc(url,0,curTable);
  }else{
    //onlineName = trigOnline[trigOnline.selectedIndex].text;
    curTable = getTable(1, newRequest, onlineName);
    name = activeApsys[apsySelect.selectedIndex];
    if(name.substr(0,3)=="ISM")
    {
      onRuleQual = "/isisj"
    }
    else if(name.substr(0,3)=="NIM")
    {
      onRuleQual = "/isisn"
    }
    url = "http://" + host + onRuleQual + name.substr(3,1)
        + "/trigxml" + parms;

    if(newRequest)
      appendTitle(curTable, name);
    loadDoc(url,0,curTable);
  }
}


if(timer){
  timer = window.clearInterval(timer);
  timer = null;
}
//... if a refesh time has been entered
seconds = refreshTimer.value;
if(seconds>4){
  seconds*=1000; //... convert to milliseconds
  timer = window.setInterval("findTriggers()",seconds);
}

}

/*
Explanation of below code:

loadDoc function loads an XML document (XMLdoc) from the URL specified. This XMLdoc will
be stored in the global XMLdoc array based on the table and column/apsy that is being processed.
Then based on the docNum (ie the column/apsy) being processed and individual event handler
is assigned to the XMLdoc.

Individual event handlers are setup for each XMLdoc. This is done so that the docs can be processed
in any order as soon as they have finished loading. This increases efficency when displaying large
numbers of apsys.

When the onreadystatechange event is fired by the XMLdoc it calls the eventhandler that has been
assigned to that XMLdoc. This event handler calls the obtainTrigs function using values stored
in the global arrays for arguments.

// */

//... Create a 2 dimensional array with 7 columns and 14 rows
//... that will hold XMLdoc Objects for the 7 tables
var docArray = new Array(new Array(14),new Array(14),new Array(14),new Array(14),new Array(14),new Array(14),new Array(14));

function loadDoc(url,docNum,table)
{
var doc, loaded, tok;

doc = new ActiveXObject('msxml.domdocument');
doc.async = true;
tok  = tokenApplet.getToken();
url += "&token="+tok;
loaded = doc.load(url);

if (loaded){
    switch(table.id)
    {
      case "table1":
        docArray[0][docNum] = doc;
        switch(docNum){
          case  0: doc.onreadystatechange=t1d0ReadyStateChange;  break;
          case  1: doc.onreadystatechange=t1d1ReadyStateChange;  break;
          case  2: doc.onreadystatechange=t1d2ReadyStateChange;  break;
          case  3: doc.onreadystatechange=t1d3ReadyStateChange;  break;
          case  4: doc.onreadystatechange=t1d4ReadyStateChange;  break;
          case  5: doc.onreadystatechange=t1d5ReadyStateChange;  break;
          case  6: doc.onreadystatechange=t1d6ReadyStateChange;  break;
          case  7: doc.onreadystatechange=t1d7ReadyStateChange;  break;
          case  8: doc.onreadystatechange=t1d8ReadyStateChange;  break;
          case  9: doc.onreadystatechange=t1d9ReadyStateChange;  break;
          case 10: doc.onreadystatechange=t1d10ReadyStateChange; break;
          case 11: doc.onreadystatechange=t1d11ReadyStateChange; break;
          case 12: doc.onreadystatechange=t1d12ReadyStateChange; break;
          case 13: doc.onreadystatechange=t1d13ReadyStateChange; break;
          case 14: doc.onreadystatechange=t1d14ReadyStateChange; break;
          case 15: doc.onreadystatechange=t1d15ReadyStateChange; break;
        }
        break;
      case "table2":
        docArray[1][docNum] = doc;
        switch(docNum){
          case  0: doc.onreadystatechange=t2d0ReadyStateChange;  break;
          case  1: doc.onreadystatechange=t2d1ReadyStateChange;  break;
          case  2: doc.onreadystatechange=t2d2ReadyStateChange;  break;
          case  3: doc.onreadystatechange=t2d3ReadyStateChange;  break;
          case  4: doc.onreadystatechange=t2d4ReadyStateChange;  break;
          case  5: doc.onreadystatechange=t2d5ReadyStateChange;  break;
          case  6: doc.onreadystatechange=t2d6ReadyStateChange;  break;
          case  7: doc.onreadystatechange=t2d7ReadyStateChange;  break;
          case  8: doc.onreadystatechange=t2d8ReadyStateChange;  break;
          case  9: doc.onreadystatechange=t2d9ReadyStateChange;  break;
          case 10: doc.onreadystatechange=t2d10ReadyStateChange; break;
          case 11: doc.onreadystatechange=t2d11ReadyStateChange; break;
          case 12: doc.onreadystatechange=t2d12ReadyStateChange; break;
          case 13: doc.onreadystatechange=t2d13ReadyStateChange; break;
          case 14: doc.onreadystatechange=t2d14ReadyStateChange; break;
          case 15: doc.onreadystatechange=t2d15ReadyStateChange; break;
        }
        break;
      case "table3":
        docArray[2][docNum] = doc;
        switch(docNum){
          case  0: doc.onreadystatechange=t3d0ReadyStateChange;  break;
          case  1: doc.onreadystatechange=t3d1ReadyStateChange;  break;
          case  2: doc.onreadystatechange=t3d2ReadyStateChange;  break;
          case  3: doc.onreadystatechange=t3d3ReadyStateChange;  break;
          case  4: doc.onreadystatechange=t3d4ReadyStateChange;  break;
          case  5: doc.onreadystatechange=t3d5ReadyStateChange;  break;
          case  6: doc.onreadystatechange=t3d6ReadyStateChange;  break;
          case  7: doc.onreadystatechange=t3d7ReadyStateChange;  break;
          case  8: doc.onreadystatechange=t3d8ReadyStateChange;  break;
          case  9: doc.onreadystatechange=t3d9ReadyStateChange;  break;
          case 10: doc.onreadystatechange=t3d10ReadyStateChange; break;
          case 11: doc.onreadystatechange=t3d11ReadyStateChange; break;
          case 12: doc.onreadystatechange=t3d12ReadyStateChange; break;
          case 13: doc.onreadystatechange=t3d13ReadyStateChange; break;
          case 14: doc.onreadystatechange=t3d14ReadyStateChange; break;
          case 15: doc.onreadystatechange=t3d15ReadyStateChange; break;
        }
        break;
      case "table4":
        docArray[3][docNum] = doc;
        switch(docNum){
          case  0: doc.onreadystatechange=t4d0ReadyStateChange;  break;
          case  1: doc.onreadystatechange=t4d1ReadyStateChange;  break;
          case  2: doc.onreadystatechange=t4d2ReadyStateChange;  break;
          case  3: doc.onreadystatechange=t4d3ReadyStateChange;  break;
          case  4: doc.onreadystatechange=t4d4ReadyStateChange;  break;
          case  5: doc.onreadystatechange=t4d5ReadyStateChange;  break;
          case  6: doc.onreadystatechange=t4d6ReadyStateChange;  break;
          case  7: doc.onreadystatechange=t4d7ReadyStateChange;  break;
          case  8: doc.onreadystatechange=t4d8ReadyStateChange;  break;
          case  9: doc.onreadystatechange=t4d9ReadyStateChange;  break;
          case 10: doc.onreadystatechange=t4d10ReadyStateChange; break;
          case 11: doc.onreadystatechange=t4d11ReadyStateChange; break;
          case 12: doc.onreadystatechange=t4d12ReadyStateChange; break;
          case 13: doc.onreadystatechange=t4d13ReadyStateChange; break;
          case 14: doc.onreadystatechange=t4d14ReadyStateChange; break;
          case 15: doc.onreadystatechange=t4d15ReadyStateChange; break;
        }
        break;
      case "table5":
        docArray[4][docNum] = doc;
        switch(docNum){
          case  0: doc.onreadystatechange=t5d0ReadyStateChange;  break;
          case  1: doc.onreadystatechange=t5d1ReadyStateChange;  break;
          case  2: doc.onreadystatechange=t5d2ReadyStateChange;  break;
          case  3: doc.onreadystatechange=t5d3ReadyStateChange;  break;
          case  4: doc.onreadystatechange=t5d4ReadyStateChange;  break;
          case  5: doc.onreadystatechange=t5d5ReadyStateChange;  break;
          case  6: doc.onreadystatechange=t5d6ReadyStateChange;  break;
          case  7: doc.onreadystatechange=t5d7ReadyStateChange;  break;
          case  8: doc.onreadystatechange=t5d8ReadyStateChange;  break;
          case  9: doc.onreadystatechange=t5d9ReadyStateChange;  break;
          case 10: doc.onreadystatechange=t5d10ReadyStateChange; break;
          case 11: doc.onreadystatechange=t5d11ReadyStateChange; break;
          case 12: doc.onreadystatechange=t5d12ReadyStateChange; break;
          case 13: doc.onreadystatechange=t5d13ReadyStateChange; break;
          case 14: doc.onreadystatechange=t5d14ReadyStateChange; break;
          case 15: doc.onreadystatechange=t5d15ReadyStateChange; break;
        }
        break;
      case "table6":
        docArray[5][docNum] = doc;
        switch(docNum){
          case  0: doc.onreadystatechange=t6d0ReadyStateChange;  break;
          case  1: doc.onreadystatechange=t6d1ReadyStateChange;  break;
          case  2: doc.onreadystatechange=t6d2ReadyStateChange;  break;
          case  3: doc.onreadystatechange=t6d3ReadyStateChange;  break;
          case  4: doc.onreadystatechange=t6d4ReadyStateChange;  break;
          case  5: doc.onreadystatechange=t6d5ReadyStateChange;  break;
          case  6: doc.onreadystatechange=t6d6ReadyStateChange;  break;
          case  7: doc.onreadystatechange=t6d7ReadyStateChange;  break;
          case  8: doc.onreadystatechange=t6d8ReadyStateChange;  break;
          case  9: doc.onreadystatechange=t6d9ReadyStateChange;  break;
          case 10: doc.onreadystatechange=t6d10ReadyStateChange; break;
          case 11: doc.onreadystatechange=t6d11ReadyStateChange; break;
          case 12: doc.onreadystatechange=t6d12ReadyStateChange; break;
          case 13: doc.onreadystatechange=t6d13ReadyStateChange; break;
          case 14: doc.onreadystatechange=t6d14ReadyStateChange; break;
          case 15: doc.onreadystatechange=t6d15ReadyStateChange; break;
        }
        break;
      case "table7":
        docArray[6][docNum] = doc;
        switch(docNum){
          case  0: doc.onreadystatechange=t7d0ReadyStateChange;  break;
          case  1: doc.onreadystatechange=t7d1ReadyStateChange;  break;
          case  2: doc.onreadystatechange=t7d2ReadyStateChange;  break;
          case  3: doc.onreadystatechange=t7d3ReadyStateChange;  break;
          case  4: doc.onreadystatechange=t7d4ReadyStateChange;  break;
          case  5: doc.onreadystatechange=t7d5ReadyStateChange;  break;
          case  6: doc.onreadystatechange=t7d6ReadyStateChange;  break;
          case  7: doc.onreadystatechange=t7d7ReadyStateChange;  break;
          case  8: doc.onreadystatechange=t7d8ReadyStateChange;  break;
          case  9: doc.onreadystatechange=t7d9ReadyStateChange;  break;
          case 10: doc.onreadystatechange=t7d10ReadyStateChange; break;
          case 11: doc.onreadystatechange=t7d11ReadyStateChange; break;
          case 12: doc.onreadystatechange=t7d12ReadyStateChange; break;
          case 13: doc.onreadystatechange=t7d13ReadyStateChange; break;
          case 14: doc.onreadystatechange=t7d14ReadyStateChange; break;
          case 15: doc.onreadystatechange=t7d15ReadyStateChange; break;
        }
        break;
    }
}else
   alert("XML Document not loaded\nURL: "+url+"\nDocNum: "+docNum+"\table: "+table.id);
}

//Event Handlers for table1
function t1d0ReadyStateChange() {obtainTrigs(docArray[0][0],0,table1,apsyCntArray[0]);}
function t1d1ReadyStateChange() {obtainTrigs(docArray[0][1],1,table1,apsyCntArray[0]);}
function t1d2ReadyStateChange() {obtainTrigs(docArray[0][2],2,table1,apsyCntArray[0]);}
function t1d3ReadyStateChange() {obtainTrigs(docArray[0][3],3,table1,apsyCntArray[0]);}
function t1d4ReadyStateChange() {obtainTrigs(docArray[0][4],4,table1,apsyCntArray[0]);}
function t1d5ReadyStateChange() {obtainTrigs(docArray[0][5],5,table1,apsyCntArray[0]);}
function t1d6ReadyStateChange() {obtainTrigs(docArray[0][6],6,table1,apsyCntArray[0]);}
function t1d7ReadyStateChange() {obtainTrigs(docArray[0][7],7,table1,apsyCntArray[0]);}
function t1d8ReadyStateChange() {obtainTrigs(docArray[0][8],8,table1,apsyCntArray[0]);}
function t1d9ReadyStateChange() {obtainTrigs(docArray[0][9],9,table1,apsyCntArray[0]);}
function t1d10ReadyStateChange(){obtainTrigs(docArray[0][10],10,table1,apsyCntArray[0]);}
function t1d11ReadyStateChange(){obtainTrigs(docArray[0][11],11,table1,apsyCntArray[0]);}
function t1d12ReadyStateChange(){obtainTrigs(docArray[0][12],12,table1,apsyCntArray[0]);}
function t1d13ReadyStateChange(){obtainTrigs(docArray[0][13],13,table1,apsyCntArray[0]);}
function t1d14ReadyStateChange(){obtainTrigs(docArray[0][14],14,table1,apsyCntArray[0]);}
function t1d15ReadyStateChange(){obtainTrigs(docArray[0][15],15,table1,apsyCntArray[0]);}

//Event Handlers for table2
function t2d0ReadyStateChange() {obtainTrigs(docArray[1][0],0,table2,apsyCntArray[1]);}
function t2d1ReadyStateChange() {obtainTrigs(docArray[1][1],1,table2,apsyCntArray[1]);}
function t2d2ReadyStateChange() {obtainTrigs(docArray[1][2],2,table2,apsyCntArray[1]);}
function t2d3ReadyStateChange() {obtainTrigs(docArray[1][3],3,table2,apsyCntArray[1]);}
function t2d4ReadyStateChange() {obtainTrigs(docArray[1][4],4,table2,apsyCntArray[1]);}
function t2d5ReadyStateChange() {obtainTrigs(docArray[1][5],5,table2,apsyCntArray[1]);}
function t2d6ReadyStateChange() {obtainTrigs(docArray[1][6],6,table2,apsyCntArray[1]);}
function t2d7ReadyStateChange() {obtainTrigs(docArray[1][7],7,table2,apsyCntArray[1]);}
function t2d8ReadyStateChange() {obtainTrigs(docArray[1][8],8,table2,apsyCntArray[1]);}
function t2d9ReadyStateChange() {obtainTrigs(docArray[1][9],9,table2,apsyCntArray[1]);}
function t2d10ReadyStateChange(){obtainTrigs(docArray[1][10],10,table2,apsyCntArray[1]);}
function t2d11ReadyStateChange(){obtainTrigs(docArray[1][11],11,table2,apsyCntArray[1]);}
function t2d12ReadyStateChange(){obtainTrigs(docArray[1][12],12,table2,apsyCntArray[1]);}
function t2d13ReadyStateChange(){obtainTrigs(docArray[1][13],13,table2,apsyCntArray[1]);}
function t2d14ReadyStateChange(){obtainTrigs(docArray[1][14],14,table2,apsyCntArray[1]);}
function t2d15ReadyStateChange(){obtainTrigs(docArray[1][15],15,table2,apsyCntArray[1]);}

//Event Handlers for table3
function t3d0ReadyStateChange() {obtainTrigs(docArray[2][0],0,table3,apsyCntArray[2]);}
function t3d1ReadyStateChange() {obtainTrigs(docArray[2][1],1,table3,apsyCntArray[2]);}
function t3d2ReadyStateChange() {obtainTrigs(docArray[2][2],2,table3,apsyCntArray[2]);}
function t3d3ReadyStateChange() {obtainTrigs(docArray[2][3],3,table3,apsyCntArray[2]);}
function t3d4ReadyStateChange() {obtainTrigs(docArray[2][4],4,table3,apsyCntArray[2]);}
function t3d5ReadyStateChange() {obtainTrigs(docArray[2][5],5,table3,apsyCntArray[2]);}
function t3d6ReadyStateChange() {obtainTrigs(docArray[2][6],6,table3,apsyCntArray[2]);}
function t3d7ReadyStateChange() {obtainTrigs(docArray[2][7],7,table3,apsyCntArray[2]);}
function t3d8ReadyStateChange() {obtainTrigs(docArray[2][8],8,table3,apsyCntArray[2]);}
function t3d9ReadyStateChange() {obtainTrigs(docArray[2][9],9,table3,apsyCntArray[2]);}
function t3d10ReadyStateChange(){obtainTrigs(docArray[2][10],10,table3,apsyCntArray[2]);}
function t3d11ReadyStateChange(){obtainTrigs(docArray[2][11],11,table3,apsyCntArray[2]);}
function t3d12ReadyStateChange(){obtainTrigs(docArray[2][12],12,table3,apsyCntArray[2]);}
function t3d13ReadyStateChange(){obtainTrigs(docArray[2][13],13,table3,apsyCntArray[2]);}
function t3d14ReadyStateChange(){obtainTrigs(docArray[2][14],14,table3,apsyCntArray[2]);}
function t3d15ReadyStateChange(){obtainTrigs(docArray[2][15],15,table3,apsyCntArray[2]);}

//Event Handlers for table4
function t4d0ReadyStateChange() {obtainTrigs(docArray[3][0],0,table4,apsyCntArray[3]);}
function t4d1ReadyStateChange() {obtainTrigs(docArray[3][1],1,table4,apsyCntArray[3]);}
function t4d2ReadyStateChange() {obtainTrigs(docArray[3][2],2,table4,apsyCntArray[3]);}
function t4d3ReadyStateChange() {obtainTrigs(docArray[3][3],3,table4,apsyCntArray[3]);}
function t4d4ReadyStateChange() {obtainTrigs(docArray[3][4],4,table4,apsyCntArray[3]);}
function t4d5ReadyStateChange() {obtainTrigs(docArray[3][5],5,table4,apsyCntArray[3]);}
function t4d6ReadyStateChange() {obtainTrigs(docArray[3][6],6,table4,apsyCntArray[3]);}
function t4d7ReadyStateChange() {obtainTrigs(docArray[3][7],7,table4,apsyCntArray[3]);}
function t4d8ReadyStateChange() {obtainTrigs(docArray[3][8],8,table4,apsyCntArray[3]);}
function t4d9ReadyStateChange() {obtainTrigs(docArray[3][9],9,table4,apsyCntArray[3]);}
function t4d10ReadyStateChange(){obtainTrigs(docArray[3][10],10,table4,apsyCntArray[3]);}
function t4d11ReadyStateChange(){obtainTrigs(docArray[3][11],11,table4,apsyCntArray[3]);}
function t4d12ReadyStateChange(){obtainTrigs(docArray[3][12],12,table4,apsyCntArray[3]);}
function t4d13ReadyStateChange(){obtainTrigs(docArray[3][13],13,table4,apsyCntArray[3]);}
function t4d14ReadyStateChange(){obtainTrigs(docArray[3][14],14,table4,apsyCntArray[3]);}
function t4d15ReadyStateChange(){obtainTrigs(docArray[3][15],15,table4,apsyCntArray[3]);}

//Event Handlers for table5
function t5d0ReadyStateChange() {obtainTrigs(docArray[4][0],0,table5,apsyCntArray[4]);}
function t5d1ReadyStateChange() {obtainTrigs(docArray[4][1],1,table5,apsyCntArray[4]);}
function t5d2ReadyStateChange() {obtainTrigs(docArray[4][2],2,table5,apsyCntArray[4]);}
function t5d3ReadyStateChange() {obtainTrigs(docArray[4][3],3,table5,apsyCntArray[4]);}
function t5d4ReadyStateChange() {obtainTrigs(docArray[4][4],4,table5,apsyCntArray[4]);}
function t5d5ReadyStateChange() {obtainTrigs(docArray[4][5],5,table5,apsyCntArray[4]);}
function t5d6ReadyStateChange() {obtainTrigs(docArray[4][6],6,table5,apsyCntArray[4]);}
function t5d7ReadyStateChange() {obtainTrigs(docArray[4][7],7,table5,apsyCntArray[4]);}
function t5d8ReadyStateChange() {obtainTrigs(docArray[4][8],8,table5,apsyCntArray[4]);}
function t5d9ReadyStateChange() {obtainTrigs(docArray[4][9],9,table5,apsyCntArray[4]);}
function t5d10ReadyStateChange(){obtainTrigs(docArray[4][10],10,table5,apsyCntArray[4]);}
function t5d11ReadyStateChange(){obtainTrigs(docArray[4][11],11,table5,apsyCntArray[4]);}
function t5d12ReadyStateChange(){obtainTrigs(docArray[4][12],12,table5,apsyCntArray[4]);}
function t5d13ReadyStateChange(){obtainTrigs(docArray[4][13],13,table5,apsyCntArray[4]);}
function t5d14ReadyStateChange(){obtainTrigs(docArray[4][14],14,table5,apsyCntArray[4]);}
function t5d15ReadyStateChange(){obtainTrigs(docArray[4][15],15,table5,apsyCntArray[4]);}

//Event Handlers for table6
function t6d0ReadyStateChange() {obtainTrigs(docArray[5][0],0,table6,apsyCntArray[5]);}
function t6d1ReadyStateChange() {obtainTrigs(docArray[5][1],1,table6,apsyCntArray[5]);}
function t6d2ReadyStateChange() {obtainTrigs(docArray[5][2],2,table6,apsyCntArray[5]);}
function t6d3ReadyStateChange() {obtainTrigs(docArray[5][3],3,table6,apsyCntArray[5]);}
function t6d4ReadyStateChange() {obtainTrigs(docArray[5][4],4,table6,apsyCntArray[5]);}
function t6d5ReadyStateChange() {obtainTrigs(docArray[5][5],5,table6,apsyCntArray[5]);}
function t6d6ReadyStateChange() {obtainTrigs(docArray[5][6],6,table6,apsyCntArray[5]);}
function t6d7ReadyStateChange() {obtainTrigs(docArray[5][7],7,table6,apsyCntArray[5]);}
function t6d8ReadyStateChange() {obtainTrigs(docArray[5][8],8,table6,apsyCntArray[5]);}
function t6d9ReadyStateChange() {obtainTrigs(docArray[5][9],9,table6,apsyCntArray[5]);}
function t6d10ReadyStateChange(){obtainTrigs(docArray[5][10],10,table6,apsyCntArray[5]);}
function t6d11ReadyStateChange(){obtainTrigs(docArray[5][11],11,table6,apsyCntArray[5]);}
function t6d12ReadyStateChange(){obtainTrigs(docArray[5][12],12,table6,apsyCntArray[5]);}
function t6d13ReadyStateChange(){obtainTrigs(docArray[5][13],13,table6,apsyCntArray[5]);}
function t6d14ReadyStateChange(){obtainTrigs(docArray[5][14],14,table6,apsyCntArray[5]);}
function t6d15ReadyStateChange(){obtainTrigs(docArray[5][15],15,table6,apsyCntArray[5]);}

//Event Handlers for table7
function t7d0ReadyStateChange() {obtainTrigs(docArray[6][0],0,table7,apsyCntArray[6]);}
function t7d1ReadyStateChange() {obtainTrigs(docArray[6][1],1,table7,apsyCntArray[6]);}
function t7d2ReadyStateChange() {obtainTrigs(docArray[6][2],2,table7,apsyCntArray[6]);}
function t7d3ReadyStateChange() {obtainTrigs(docArray[6][3],3,table7,apsyCntArray[6]);}
function t7d4ReadyStateChange() {obtainTrigs(docArray[6][4],4,table7,apsyCntArray[6]);}
function t7d5ReadyStateChange() {obtainTrigs(docArray[6][5],5,table7,apsyCntArray[6]);}
function t7d6ReadyStateChange() {obtainTrigs(docArray[6][6],6,table7,apsyCntArray[6]);}
function t7d7ReadyStateChange() {obtainTrigs(docArray[6][7],7,table7,apsyCntArray[6]);}
function t7d8ReadyStateChange() {obtainTrigs(docArray[6][8],8,table7,apsyCntArray[6]);}
function t7d9ReadyStateChange() {obtainTrigs(docArray[6][9],9,table7,apsyCntArray[6]);}
function t7d10ReadyStateChange(){obtainTrigs(docArray[6][10],10,table7,apsyCntArray[6]);}
function t7d11ReadyStateChange(){obtainTrigs(docArray[6][11],11,table7,apsyCntArray[6]);}
function t7d12ReadyStateChange(){obtainTrigs(docArray[6][12],12,table7,apsyCntArray[6]);}
function t7d13ReadyStateChange(){obtainTrigs(docArray[6][13],13,table7,apsyCntArray[6]);}
function t7d14ReadyStateChange(){obtainTrigs(docArray[6][14],14,table7,apsyCntArray[6]);}
function t7d15ReadyStateChange(){obtainTrigs(docArray[6][15],15,table7,apsyCntArray[6]);}

function obtainTrigs(doc,column,table,apsyCnt)
{
var len,i,host,trigNodesCnt, trigNodes,tableCnt;
var updSfx, updHost, updAccess, kwd, logApsy;

//... Check to see if the XML document has completed loading if not then return
//... The XMLdoc has 4 readyStates of loading(1), loaded(2), interactive(3) and complete(4)
//... Processing of the doc can only be done once it has reached the complete state.
if(doc.readyState!=4)
  return;

findTriggerButton.disabled = true;
window.status = "Calculating ...";

//... Select the entire document
trigNodes = doc.selectSingleNode('//trigs');

//... Check to see if the XML contains any data
if(trigNodes.length<1){
  findTriggerButton.disabled = false;
  window.status = "Done.";
  return;
}
updSfx = trigNodes.getAttribute("updSfx");
kwd    = trigNodes.getAttribute("kwd");
updHost = trigNodes.getAttribute("updHost");
updAccess = trigNodes.getAttribute("updAccess");
logApsy = trigNodes.getAttribute("logApsy");

trigNodes = null;
//... Select all the trig nodes
trigNodes = doc.selectNodes('trigs/trig');
trigNodesCnt = trigNodes.length;

//... Check to see if the XML contains any trig nodes
if(trigNodesCnt<1){
  findTriggerButton.disabled = false;
  window.status = "Done.";
  return;
}

lastRow = 1;

loadID = new Date();

for(trigPos=0;trigPos<trigNodesCnt;trigPos++){
  processTrig(trigNodes[trigPos],table,column,apsyCnt,
              updSfx,updHost,updAccess,kwd,logApsy);
}

//... Cleanup old cells where cell.loadID is not equal to loadID
tableCnt = table.childNodes.length;
rows = table.rows;
for(i=1;i<tableCnt;i++){
  cell = rows[i].cells[column+2];
  if(cell.getAttribute('loadID')!=loadID){
    cell.innerHTML = '&nbsp;';
    cell.bgColor = 'white';
    cell.title = rows[i].title;
  }
}

//... Build and Display Totals
for(i=1;i<tableCnt;i++){
  cells = rows[i].cells;
  columnCnt = cells.length-1;
  total = 0;
  for(j=2;j<columnCnt;j++){
    cell = cells[j];
    total += new Number(cell.innerText);
  }
  if(total)
    cells[columnCnt].innerText = total;
  else
    cells[columnCnt].innerText = ' ';
}

findTriggerButton.disabled = false;
window.status = "Done";
}

function processTrig(trigNode, table, column, apsyCnt, updSfx, updHost, updAccess, kwd, logApsy)
{
var prev,logBugErr,diffTxt;
var trigAct,trigSts,trigCnt,key,cell,thisRow,row,wrkRow,updId;

trigAct  = trigNode.getAttribute("name");
trigSts  = trigNode.getAttribute("sts");
trigCnt  = trigNode.getAttribute("cnt");
updId    = trigAct + ';' + trigSts + ';' + trigCnt + ';' +
           updSfx  + ';' + updHost + ';' + gUserId + ';' +
           kwd     + ';' + logApsy + ';';

key = trigAct + ';' + trigSts + ';' + column + ';';
//... Find the row in the table for an existing trigger
//... Note: This "all" search searches on the 'id' attributes
//    of the table rows and cells
cell = table.all(key);

if(cell){//... If the trigger with this status is found in the table
  thisRow = cell.parentNode.rowIndex;

  prev = cell.innerText;
  if(prev!=' '){
    if(parseInt(prev) > parseInt(trigCnt))
    {
       diffTxt = " Down by " + (parseInt(prev) - parseInt(trigCnt));
    }
    else if(parseInt(trigCnt) > parseInt(prev))
    {
       diffTxt = " Up by " + (parseInt(trigCnt) - parseInt(prev));
    }
    else
    {
       diffTxt = " No change.";
    }

    cell.title = "Action\t\t:" + cell.parentNode.name + "\n"
               + "Status\t\t:" + cell.parentNode.sts + "\n"
               + "Previous Count\t:" + prev + "\n"
               + "This Count\t:" + trigCnt + "\n"
               + "Difference\t:" + diffTxt;

    if(new Number(prev)>new Number(trigCnt))
      cell.bgColor = "lightgreen";
    else if(new Number(prev)<new Number(trigCnt))
      cell.bgColor = "lightpink";
    else
      cell.bgColor = "white";
  }else{
    cell.bgColor = "white";
  }
  cell.loadID = loadID;
  cell.innerText = trigCnt;

  logBugErr = false;
  if (trigSts == '#LOG' || trigSts == '#ERROR' ||
      trigSts == '#CAN' || trigSts == '#COM'   ||
      trigSts == '#BUG' || trigSts == '#ERRZZ'  ) logBugErr = true;

  if (logBugErr)
  {
    cell.innerHTML = '<span name=' + cell.id + ' id=' + updId +
                     ' onclick="displayMoreInfo(id)">'
                     + trigCnt + '</span>';
  }
  else
  {
    if (updAccess == 'Y')
    {
      cell.innerHTML = '<span name=' + cell.id + ' id=' + updId +
                       ' onclick="updTriggerStatus(id);findTriggers()">'
                       + trigCnt + '</span>';
      cell.className = "trig";
    }
    else
    {
      cell.className = "mtCell";
    }
  }
}else{
  key = trigAct + ';';

  cell = table.all(key);

  if(cell){
    //... trigger name already exists in the table but not for this status so add extra cell to row
    wrkRow = cell.parentNode;

    row = findRow(table,trigAct,trigSts,wrkRow.rowIndex);
    thisRow = addRow(table,row,column,trigAct,trigSts,trigCnt,apsyCnt,false,updId,updAccess)
  }else{ //... New trigger so add extra row
    row = findRow(table,trigAct,trigSts,lastRow);
    thisRow = addRow(table,row,column,trigAct,trigSts,trigCnt,apsyCnt,true,updId,updAccess)
  }
}

if(thisRow>lastRow)
  lastRow=thisRow;
else
  lastRow++;
}

</script>

<object
 name     = "tokenApplet"
 id       = "tokenApplet"
 width    = 0
 height   = 0
 classid  = "clsid:8AD9C840-044E-11D1-B3E9-00805F499D93"
 codebase ="http://java.sun.com/products/plugin/1.2
           /jinstall-12-win32.cab#Version=1,2,0,0">

<PARAM NAME=CODE
VALUE="au.gov.centrelink.security.acfsinglesignon.TokenApplet">
<PARAM NAME=ARCHIVE VALUE="sso.jar">
<PARAM NAME=SCRIPTABLE VALUE="true">
<PARAM NAME="type"
VALUE="application/x-java-applet;version=1.2">
<PARAM NAME="trace" VALUE="true">
<PARAM NAME="reportOnly" VALUE="false">
<PARAM NAME="tokenType" VALUE="3">
<PARAM NAME="relativeToHost" VALUE="false">
<COMMENT><EMBED
name="au.gov.centrelink.security.acfsinglesignon.TokenApplet"
type="application/x-java-applet;version=1.2"
java_CODE="au.gov.centrelink.security.acfsinglesignon.TokenApplet"
java_ARCHIVE="sso.jar"
WIDTH=1
HEIGHT=1
authenticationURL="http://cnet-dev/ITSecurity/servlet/SingleSignOn"
pluginspage="http://java.sun.com/products/plugin/1.2/plugin-install.html"
trace="true"
reportOnly="false"
relativeToHost="false">
</EMBED></COMMENT>
</object>

</body>
</html>
